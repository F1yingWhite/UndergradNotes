# 总线基本概念
总线实际上由许多的传输线和通路组成，每天限可以一位一位的传输二进制，若干条可以一起传输。![[Pasted image 20240506221749.png|500]]
# 总线分类
## 片内总线
片内总线指的是在芯片内部的总线,比如cpu内,寄存器之间的链接
## 系统总线
指的是各大部件之间的信息传输线,比如CPU,主存,IO设置等
1. 数据总线用来传输各功能部件之间的数据信息,其位数与存储字长有关.如果数据总线的宽度为8位,指令字长16位,那么cpu在取址阶段必须访问两次主存
2. 地址总线:地址总线用来指出数据总线上的元数据在主存单元的地址
3. 控制总线:用来控制各部件在不同时刻使用总线的使用权,防止冲突
## 通信总线
用于系统之间的通信,串行通信是指数据在一位宽的传输总线上一位一位的传输.并行通信是指一起发,用于短距离的通信
# 特征和性能指标
## 特征
总线的特性主要有:
- 机械特性:指总线在机械连接上的性能,比如引脚的个数..
- 电气特性:总线的每一根传输线上信号的传递方式和有效的电频范围.
- 功能特性:用于传输地址码/传输数据等
- 时间特性:总线的任何一根线在什么时间内有效
## 性能指标
- 总线宽度:指数据总线的根数,比如8位,64位等
- 总线带宽:指的是总线的数据传输速度,即单位时间上的传输位数.比如评率为33mhz,带宽为32位,那么总贷款就是33\*4B = 132MBps
- 时钟同步/异步:总线上的数据与时钟同步工作叫同步总线,不同步叫异步总线
- 总线复用:总线能穿2种信号
- 信号线数:...
# 总线结构
## 单总线结构
将CPU/主存/IO都挂在一组总线上,结构简单且易于扩充,但是容易形成瓶颈.
## 多总线结构
双总线结构的特点是将IO设备从单总线上分离,形成总线与IO总线分开的结构.CPU放出一部分功能,用于处理外部设备与主存储器的数据传输,使系统的吞吐能力变大
三总线结构:将速率不同的IO设备分类,再把他们链接在不同的通道上,那么计算机系统的工作效率会更高.![[Pasted image 20240512201003.png]]
如图,....
# 总线控制
## 总线判优控制
总线上所连接的设备,按照其对总线有无控制功能分为主设备和从设备.主设备能够控制总线,而从设备只能听取总线的控制.总线判优控制可分为集中和分布两种
集中控制有如下三种:
- 链式查询:有三根线用于总线控制:BS总线忙,BR总线请求,BG总线同意.其中BG串行的从一个IP接口送到下一个IO接口,如果BG到达的接口有BR,那就不在往下传而让他建立BS请求.离总线最近的有最高优先级
- 计数器定时查询:与链式查询少了一组同意总线. 假设总线仲裁器中计数初值为0，这时设备2、4都通过BR线发出请求，如果设备不忙既BS为0，计数器开始从0计数。并通过设备地址线查看该设备是否发出请求，如果是，则响应否则继续计数。这里设备0没有请求，继续计数直至2，发现设备2有请求则响应，并将BS线设为1。  如果每次查询计数器都从0开始，那么毫无疑问设备优先级和链式查询一样。如果从中止点开始（如上例中下次查询计数器从2开始计数并查询），
- 独立请求方式:每台设备都有一对总线请求和总线同意.当设备要使用的时候就发出请求信号.总线控制部件有一排队电路,可根据顺序决定哪个先来
## 总线通信控制
在争夺总线使用权的时候,应该按照各部件的优先等级来.在通信时间上,按照分时的方式来.分为4部
- 申请分配阶段:由需要使用总线的模块发出省去,进过总线仲裁机构决定下一传输周期的总线使用权是谁的
- 寻址:取得使用权的模块访问需要的地址和命令
- 传数阶段:主模块和从模块进行数据交换
- 结束:主模块的信息从总线上删除,让出使用权
![[Pasted image 20240512202356.png]]
cpu在t1上升沿发出地址信息,在t2上升沿发出读命令,与地址信号相符的输入设备按照命令进行独操作,且在t3上升沿到来前把cpu所需的数据送到数据总线上.在t3的时钟周期内,信息发送到寄存器,在t4取消读命令.

对于异步的通信,分为不互锁,半互锁和全互锁3种![[Pasted image 20240512202938.png]]
- 不互锁:主模块发出信号后,不必等待从模块的回答,而是进过一段时间确认从模块收到信号后便撤销信号;从模块接到信号在条件允许时发出回复,确认收到后撤销回复.例如向主存写信息
- 半互锁:发出信号后必须等待回复才撤销.而从模块接受后发出回复,不必等待主模块的请求信号,而是一段时间后自动撤销.比如cpu要访问共享寄存器,该CPU发出访问.必须收到未被占用的回复才会进行访问
- 全互锁:主模块发送信号,等待从模块回复后再撤销请求,从模块确认主模块收到后再撤销.,比如网络通信
异步通信key用于并行/串行传输.在串行的过程中数据传输速率用波特率衡量,波特率是单位时间传输二进制的位数,即为bps,比特率就是波特率中发送信息的多少.一般异步使用1位起始位,8为数据,1奇偶校验和1位终止符

半同步通信:允许不同模块以不同速度工作,又保留了同步通信的特点:所有的信号发出时间都遵守时钟.因此引入了等待信号线来协调双方的配合问题.
